# react核心

- create-react-app使用
- 掌握组件使用
- 掌握JSX语法
- 掌握setState
- 理解组件生命周期
- 掌握组件通信各种方式

## 使用脚手架创建项目

1. 安装官方脚手架： `npm install -g create-react-app`
2. 创建项目：`create-react-app 项目名`
3. 启动项目：`npm start`

## 文件结构

### 文件结构一览

```markdown
my-app
├── README.md                 文档
├── node_modules  
├── package.json              npm 依赖
├── .gitignore
├── public                    静态资源
│   ├── favicon.ico
│   ├── index.html
│   └── manifest.json
└── src                       源码
    ├── App.css
    ├── App.js                  根组件
    ├── App.test.js
    ├── index.css             全局样式
    ├── index.js              入口文件
    ├── logo.svg
    └── serviceWorker.js      pwa支持
```

### cra项目真容

使用`npm run eject`弹出项目真容，会多出两个目录：

```markdown
├── config                    静态资源
│   ├── env.js 处理.env环境变量配置文件
│   ├── paths.js 提供各种路径
│   ├── webpack.config.js webpack配置文件
│   └── webapckDevServer.config.js 测试服务器配置文件
└── script 启动、打包和测试脚本                       
    ├── build.js 打包脚本
    ├── start.js 启动脚本
    └── test.js  测试脚本
```

env.js用来处理.env文件中配置的环境变量 

```js
// node运行环境：development、production、test等
const NODE_ENV = process.env.NODE_ENV;
// 要扫描的文件名数组
var dotenvFiles = [
	`${paths.dotenv}.${NODE_ENV}.local`, // .env.development.local
	`${paths.dotenv}.${NODE_ENV}`, // .env.development
	NODE_ENV !== 'test' && `${paths.dotenv}.local`, // .env.local
  paths.dotenv, // .env
].filter(Boolean);

// 从.env*文件加载环境变量
dotenvFiles.forEach(dotenvFile => {
  if (fs.existsSync(dotenvFile)) {
    require('dotenv-expand')(
    require('dotenv').config({
      path: dotenvFile,
    })
    );
  }
});
```

实践一下，修改一下默认端口号，创建.env文件 

```js
PORT=8080
```

webpack.config.js 是webpack配置文件，开头的常量声明可以看出cra能够支持ts、sass及css模块化 

```js
// Check if TypeScript is setup
const useTypeScript = fs.existsSync(paths.appTsConfig);
// style files regexes
const cssRegex = /\.css$/;
const cssModuleRegex = /\.module\.css$/;
const sassRegex = /\.(scss|sass)$/;
const sassModuleRegex = /\.module\.(scss|sass)$/;
```

## React和ReactDom

删除 src 下面所有代码，新建 index.js

```js
import React from 'react'
import ReactDOM from 'react-dom'

ReactDOM.render(<h1>React</h1>, document.querySelector('#root'));
```

- React 负责逻辑控制，数据 -> VDOM 
- ReactDom 渲染实际 DOM，VDOM -> DOM，如果换到移动端，就用别的库来渲染
- React 使用 JSX 来描述 UI 

入口文件定义，webpack.config.js 

```js
entry: [
  // WebpackDevServer客户端，它实现开发时热更新功能
  isEnvDevelopment &&
  require.resolve('react-dev-utils/webpackHotDevClient'),
  // 应用程序入口：src/index
  paths.appIndexJs,
].filter(Boolean),
```

## JSX

JSX 是一种 JavaScript 的语法扩展，其格式比较像模版语言，但事实上完全是在 JavaScript 内部实现的。
JSX 可以很好地描述 UI，能够有效提高开发效率 。

### 使用 JSX

表达式`{}`的使用，index.js 

```js
const name = "react study";
const jsx = <h2>{name}</h2>;
```

函数也是合法表达式，index.js 

```js
const user = { firstName: "tom", lastName: "jerry" };
function formatName(user) {
	return user.firstName + " " + user.lastName;
} 
const jsx = <h2>{formatName(user)}</h2>;
```



## 组件

### 组件的两种形式

### 组件状态管理

## 事件处理

## 组件通信

## 生命周期

## 生命周期探究

## React v16.4 的生命周期





css模块化 挂一小串哈希字符串

组件通信

创建组件快捷方式 

- class组件，rcc，需安装插件`ES7 React/Redux/GraphQL/React-Native snippets`
- function 组件，rfc

直接导入 插件 auto import

react 插件 

vscode react 无法通过`ctrl+ /`注释 jsx，是因为 babel 相关插件，关闭即可。



获取变更之后的值， 原生事件中修改状态，setState 是同步的



事件处理

表单控件，一定有状态和改变状态后的事件处理函数

函数 this 指向问题，

- constructor 中 bind 绑定this
- 使用箭头函数
- 声明成属性，让属性值是箭头函数

组件通信

生命周期

componentWillMount 可以 可以 但是不建议，主要是因为版本变更导致的问题放在 didmount中合适些

< 16.3 16.3 16.4